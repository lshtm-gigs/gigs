<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extending the INTERGROWTH-21st Newborn Size Standards • gigs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extending the INTERGROWTH-21st Newborn Size Standards">
<meta name="description" content="Our process for extending the GA range INTERGROWTH-21st Newborn Size standards.">
<meta property="og:description" content="Our process for extending the GA range INTERGROWTH-21st Newborn Size standards.">
<meta property="og:image" content="https://lshtm-gigs.github.io/gigs/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gigs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/gigs.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lshtm-gigs/gigs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extending the INTERGROWTH-21st Newborn Size Standards</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lshtm-gigs/gigs/blob/master/vignettes/articles/extending-ig-nbs.rmd" class="external-link"><code>vignettes/articles/extending-ig-nbs.rmd</code></a></small>
      <div class="d-none name"><code>extending-ig-nbs.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lshtm-gigs/gigs/" class="external-link">gigs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mfp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Loading required package: survival</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="rationale">Rationale<a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>Over the years, there have been many requests from users of the
INTERGROWTH-21<sup>st</sup> Newborn Size Standards (including the Very
Preterm standards) to extend their range from 168 to 300 days
(24<sup>+0</sup> to 42<sup>+6</sup> weeks) gestational age (GA) to a
wider span of 154 to 314 days (22<sup>+0</sup> to 44<sup>+6</sup> weeks)
GA. We’ve decided to implement this in <strong>gigs</strong> as an
entirely separate standard from the INTERGROWTH-21<sup>st</sup> Newborn
Size standards, to make these extended versions of the standards
available to all.</p>
<p>We want to note here that this process has been checked over by the
former Lead Statistician for the INTERGROWTH-21<sup>st</sup> Project,
Eric Ohuma, but is not endorsed officially by
INTERGROWTH-21<sup>st</sup>. We want users to be aware that
z-scores/centiles derived from these extended bounds must be used with
caution - it is at the user’s discretion to ensure they are careful with
these extended standards.</p>
</div>
<div class="section level2">
<h2 id="approach">Approach<a class="anchor" aria-label="anchor" href="#approach"></a>
</h2>
<div class="section level3">
<h3 id="for-the-very-preterm-standards">For the Very Preterm standards<a class="anchor" aria-label="anchor" href="#for-the-very-preterm-standards"></a>
</h3>
<p>For the INTERGROWTH-21<sup>st</sup> Very Preterm standards, extending
the standards is easy. The Very Preterm standards use simple equations
to model the mean and standard deviation at different gestational ages
(GAs). Extending these standards is as simple as using gestational age
values from 154 to 167 in these equations.</p>
</div>
<div class="section level3">
<h3 id="for-the-newborn-size-standards">For the Newborn Size standards<a class="anchor" aria-label="anchor" href="#for-the-newborn-size-standards"></a>
</h3>
<p>The INTERGROWTH-21<sup>st</sup> Newborn Size standards are more
difficult to extend as they are coefficient-based. For each gestational
age from 231 days (33<sup>+0</sup> weeks) to 300 days (42<sup>+6</sup>
weeks), there are corresponding mu/sigma/nu/tau values. These are used
with <code><a href="https://rdrr.io/pkg/gamlss.dist/man/ST1.html" class="external-link">gamlss.dist::pST3()</a></code> to convert values to centiles in
these standards, and with <code><a href="https://rdrr.io/pkg/gamlss.dist/man/ST1.html" class="external-link">gamlss.dist::qST3()</a></code> to convert
centiles to values. Each coefficient represents a different aspect of
the distribution of anthropometric measures at a given gestational
age:</p>
<ul>
<li>
<code>mu</code> - The median of the distribution at a given GA.</li>
<li>
<code>sigma</code> - The standard deviation of the distribution at a
given GA.</li>
<li>
<code>nu</code> - The skewness of the distribution at a given
GA.</li>
<li>
<code>tau</code> - The kurtosis of the distribution at a given
GA.</li>
</ul>
<p>To extend these standards out, we need to generate new coefficients
for gestational ages from 301 to 314 days (43<sup>+0</sup> to
44<sup>+6</sup> weeks). We will do this with fractional polynomial
regression in <code>{mfp}</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="extrapolating-coefficients-for-the-newborn-size-standards">Extrapolating coefficients for the Newborn Size Standards<a class="anchor" aria-label="anchor" href="#extrapolating-coefficients-for-the-newborn-size-standards"></a>
</h2>
<p>The <code>mu</code> and <code>sigma</code> values are different
across GAs for each standard. Luckily, the <code>nu</code> and
<code>tau</code> parameters are identical across all gestational ages
for most of these standards. Using <code><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique()</a></code>, we see that
for all INTERGROWTH-21<sup>st</sup> Newborn Size standards except female
length-for-GA (<code>lfga</code>/<code>female</code>), <code>nu</code>
and <code>tau</code> are constant.</p>
<pre><code><span><span class="co">#&gt; Weight-for-GA:</span></span>
<span><span class="co">#&gt;  Male:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 1.095261</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 17.05299</span></span>
<span><span class="co">#&gt;  Female:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 1.126787</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 19.65738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Length-for-GA:</span></span>
<span><span class="co">#&gt;  Male:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 1.007603</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 15.4146</span></span>
<span><span class="co">#&gt;  Female:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 0.967756, 0.9677558</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 19.95849</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Head circumference-for-GA:</span></span>
<span><span class="co">#&gt;  Male:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 1.033177</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 26.17975</span></span>
<span><span class="co">#&gt;  Female:</span></span>
<span><span class="co">#&gt;       Unique `nu` values: 1.045915</span></span>
<span><span class="co">#&gt;       Unique `tau` values: 20.97268</span></span></code></pre>
<p>Looking at the <code>nu</code> values for length-for-GA in females,
we see that only the first value is different (<code>0.9677560</code>).
Every other value in this vector is <code>0.9677568</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gigs</span><span class="fu">::</span><span class="va"><a href="../reference/ig_nbs_coeffs.html">ig_nbs_coeffs</a></span><span class="op">$</span><span class="va">lfga</span><span class="op">$</span><span class="va">female</span><span class="op">$</span><span class="va">nu</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] 0.9677560 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt;  [8] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [15] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [22] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [29] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [36] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [43] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [50] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [57] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span>
<span><span class="co">#&gt; [64] 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558 0.9677558</span></span></code></pre>
<p>We will assume for this set of coefficients that <code>nu</code> is
equal to <code>0.967758</code> after 300 days’ GA; for all other sets of
coefficients we know that <code>nu</code> and <code>tau</code> are
constant throughout.</p>
<p>The <code>mu</code> and <code>sigma</code> parameters for each
standard require extrapolation. The following function uses
<code><a href="https://rdrr.io/pkg/mfp/man/mfp.html" class="external-link">mfp::mfp()</a></code> to model the slope of <code>mu</code> and
<code>sigma</code> values against GA in each set of standards using
fractional polynomials. The resulting fractional polynomial produced by
can then be used with <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> to extrapolate the slopes
out to 314 days’ GA.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extrapolate_msnt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">acronym</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">existing_coeffs</span> <span class="op">&lt;-</span> <span class="fu">gigs</span><span class="fu">::</span><span class="va"><a href="../reference/ig_nbs_coeffs.html">ig_nbs_coeffs</a></span><span class="op">[[</span><span class="va">acronym</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">sex</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Increase alpha cut-off from 0.05 to make `mfp()` 'take' to some standards</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span>  <span class="co"># Subset for fracpoly regresion; improves transition to &gt;300 days vs. using</span></span>
<span>  <span class="co"># entire GA range</span></span>
<span>  <span class="va">modelling_cutoff</span> <span class="op">&lt;-</span> <span class="fl">280</span></span>
<span>  <span class="va">modelling_coeffs</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">existing_coeffs</span>, <span class="va">gest_days</span> <span class="op">&gt;=</span> <span class="va">modelling_cutoff</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mfp_mu</span> <span class="op">&lt;-</span> <span class="fu">mfp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mfp/man/mfp.html" class="external-link">mfp</a></span><span class="op">(</span><span class="va">mu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mfp/man/fp.html" class="external-link">fp</a></span><span class="op">(</span><span class="va">gest_days</span>, df <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">modelling_coeffs</span>,</span>
<span>                     maxits <span class="op">=</span> <span class="fl">200</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">coeffs_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gest_days <span class="op">=</span> <span class="fl">231</span><span class="op">:</span><span class="fl">314</span><span class="op">)</span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mfp_mu</span>, newdata <span class="op">=</span> <span class="va">coeffs_ext</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mfp_sigma</span> <span class="op">&lt;-</span> <span class="fu">mfp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mfp/man/mfp.html" class="external-link">mfp</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mfp/man/fp.html" class="external-link">fp</a></span><span class="op">(</span><span class="va">gest_days</span>, df <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">modelling_coeffs</span>,</span>
<span>                        maxits <span class="op">=</span> <span class="fl">200</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mfp_sigma</span>, newdata <span class="op">=</span> <span class="va">coeffs_ext</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="va">existing_coeffs</span><span class="op">$</span><span class="va">nu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="va">existing_coeffs</span><span class="op">$</span><span class="va">tau</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Replace predicted coeffs with old coeffs for old GA range</span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fl">231</span><span class="op">:</span><span class="fl">300</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">existing_coeffs</span><span class="op">$</span><span class="va">mu</span></span>
<span>  <span class="va">coeffs_ext</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fl">231</span><span class="op">:</span><span class="fl">300</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">existing_coeffs</span><span class="op">$</span><span class="va">sigma</span></span>
<span>  <span class="va">coeffs_ext</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let’s iterate through our different standards and sexes. We store the
results in <code>ig_nbs_ext_coeffs</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ig_nbs_ext_coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wfga <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>male <span class="op">=</span> <span class="cn">NULL</span>, female <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>                          lfga <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>male <span class="op">=</span> <span class="cn">NULL</span>, female <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>                          hcfga <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>male <span class="op">=</span> <span class="cn">NULL</span>, female <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">acronym</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wfga"</span>, <span class="st">"lfga"</span>, <span class="st">"hcfga"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">sex</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ig_nbs_ext_coeffs</span><span class="op">[[</span><span class="va">acronym</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">sex</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">extrapolate_msnt</span><span class="op">(</span><span class="va">acronym</span>, <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-the-extrapolated-coefficients">Plotting the extrapolated coefficients<a class="anchor" aria-label="anchor" href="#plotting-the-extrapolated-coefficients"></a>
</h2>
<p>The dark grey dashed line marks the point at which we start using the
original coefficient values to fit a fractional polynomial to the data.
The light grey line shows where the extrapolation begins. Our plots show
good extrapolations in these coefficients.</p>
<div class="section level5">
<h5 id="weight-for-ga-male">Weight-for-GA: male<a class="anchor" aria-label="anchor" href="#weight-for-ga-male"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_wfga_male-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
<div class="section level5">
<h5 id="weight-for-ga-female">Weight-for-GA: female<a class="anchor" aria-label="anchor" href="#weight-for-ga-female"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_wfga_female-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis for weight-for-GA in males. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
<div class="section level5">
<h5 id="length-for-ga-male">Length-for-GA: male<a class="anchor" aria-label="anchor" href="#length-for-ga-male"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_lfga_male-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis for weight-for-GA in females. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
<div class="section level5">
<h5 id="length-for-ga-female">Length-for-GA: female<a class="anchor" aria-label="anchor" href="#length-for-ga-female"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_lfga_female-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis for length-for-GA in males. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
<div class="section level5">
<h5 id="head-circumference-for-ga-male">Head circumference-for-GA: male<a class="anchor" aria-label="anchor" href="#head-circumference-for-ga-male"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_hcfga_male-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis for head circumference-for-GA in males. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
<div class="section level5">
<h5 id="head-circumference-for-ga-female">Head circumference-for-GA: female<a class="anchor" aria-label="anchor" href="#head-circumference-for-ga-female"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/coeff_plot_hcfga_female-1.png" alt="Two line graphs showing coefficient value on the y-axis by gestational age (in days) on the x-axis for head circumference-for-GA in males. At 300 days, a vertical dashed grey line indicates that extrapolation of the values of the mu and sigma coefficients begins. After this line, the value of mu and sigma change similarly to before interpolation was carried out." width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="plotting-the-extended-standards">Plotting the extended standards<a class="anchor" aria-label="anchor" href="#plotting-the-extended-standards"></a>
</h2>
<p>The following code has two functions. The first,
<code>generate_extrapolated_ig_nbs()</code>, produces a long data frame
with anthropometry for the 3<sup>rd</sup>, 10<sup>th</sup>,
25<sup>th</sup>, 50<sup>th</sup>, 75<sup>th</sup>, 90<sup>th</sup>, and
97<sup>th</sup> centiles. The second function
(<code>plot_extrapolated_ig_nbs()</code>) uses these to graph the
centiles, with grey dashed lines at 168 and 300 days to indicate where
extrapolation of the INTERGROWTH-21<sup>st</sup> Very Preterm Newborn
standards stops and extrapolation of the extrapolation of the
INTERGROWTH-21<sup>st</sup> Newborn Size standards starts, respectively.
Each plot has a gap at 231 days (33<sup>+0</sup> weeks), where we switch
from using the INTERGROWTH-21<sup>st</sup> Very Preterm standards to the
INTERGROWTH-21<sup>st</sup> Newborn Size standards.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generate_extrapolated_ig_nbs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">acronym</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>, <span class="fl">0.97</span><span class="op">)</span>,</span>
<span>    .y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P03"</span>, <span class="st">"P10"</span>, <span class="st">"P25"</span>, <span class="st">"P50"</span>, <span class="st">"P75"</span>, <span class="st">"P90"</span>, <span class="st">"P97"</span><span class="op">)</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">centile</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">vpns_lim</span> <span class="op">&lt;-</span> <span class="fl">231</span></span>
<span>      <span class="va">gest_days</span> <span class="op">&lt;-</span> <span class="fl">154</span><span class="op">:</span><span class="fl">314</span></span>
<span>      <span class="va">y_nbs_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ig_nbs_ext_coeffs</span><span class="op">[[</span><span class="va">acronym</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">sex</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                        <span class="fu">gamlss.dist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/ST1.html" class="external-link">qST3C</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">centile</span>,</span>
<span>                                            mu <span class="op">=</span> <span class="va">mu</span>,</span>
<span>                                            sigma <span class="op">=</span> <span class="va">sigma</span>,</span>
<span>                                            nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>                                            tau <span class="op">=</span> <span class="va">tau</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">y_vpns_ext</span> <span class="op">&lt;-</span> <span class="fu">gigs</span><span class="fu">:::</span><span class="fu">ig_vpns_zscore2value</span><span class="op">(</span>z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">centile</span><span class="op">)</span>,</span>
<span>                                                <span class="fl">154</span><span class="op">:</span><span class="fl">230</span>,</span>
<span>                                                <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">sex</span>,</span>
<span>                                                       male <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>                                                       female <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span>,</span>
<span>                                                <span class="va">acronym</span><span class="op">)</span></span>
<span>      <span class="va">standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>        test <span class="op">=</span> <span class="va">gest_days</span> <span class="op">&gt;=</span> <span class="va">vpns_lim</span>,</span>
<span>        yes <span class="op">=</span> <span class="st">"NS"</span>,</span>
<span>        no <span class="op">=</span> <span class="st">"Very Preterm NS"</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gest_days <span class="op">=</span> <span class="va">gest_days</span>,</span>
<span>                      Centile <span class="op">=</span> <span class="va">name</span>,</span>
<span>                      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_vpns_ext</span>, <span class="va">y_nbs_ext</span><span class="op">)</span>,</span>
<span>                      standard <span class="op">=</span> <span class="va">standard</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot_extrapolated_chart</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">curve_data</span>, <span class="va">acronym</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">key_colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P03"</span> <span class="op">=</span> <span class="st">"#fa2c2e"</span>,</span>
<span>                   <span class="st">"P10"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   <span class="st">"P25"</span> <span class="op">=</span> <span class="st">"#ff7d2b"</span>,</span>
<span>                   <span class="st">"P50"</span> <span class="op">=</span> <span class="st">"#09843b"</span>,</span>
<span>                   <span class="st">"P75"</span> <span class="op">=</span> <span class="st">"#ff7d2b"</span>,</span>
<span>                   <span class="st">"P90"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   <span class="st">"P97"</span> <span class="op">=</span> <span class="st">"#fa2c2e"</span><span class="op">)</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="va">curve_data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gest_days</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">Centile</span>,</span>
<span>                             id <span class="op">=</span> <span class="va">standard</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">168</span>, colour <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span>, colour <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">154</span>, <span class="fl">314</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>                                labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">154</span>, <span class="fl">314</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">key_colours</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Gestational age (days)"</span>,</span>
<span>      y <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">acronym</span>,</span>
<span>                 <span class="st">"wfga"</span> <span class="op">=</span> <span class="st">"Weight (kg)"</span>,</span>
<span>                 <span class="st">"lfga"</span> <span class="op">=</span> <span class="st">"Length (cm)"</span>,</span>
<span>                 <span class="st">"hcfga"</span> <span class="op">=</span> <span class="st">"Head circumference (cm)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level5">
<h5 id="weight-for-ga-male-1">Weight-for-GA: male<a class="anchor" aria-label="anchor" href="#weight-for-ga-male-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_wfga_male-1.png" alt="A line graph showing the extrapolated growth curves for male weight-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
<div class="section level5">
<h5 id="weight-for-ga-female-1">Weight-for-GA: female<a class="anchor" aria-label="anchor" href="#weight-for-ga-female-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_wfga_female-1.png" alt="A line graph showing the extrapolated growth curves for female weight-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
<div class="section level5">
<h5 id="length-for-ga-male-1">Length-for-GA: male<a class="anchor" aria-label="anchor" href="#length-for-ga-male-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_lfga_male-1.png" alt="A line graph showing the extrapolated growth curves for male length-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
<div class="section level5">
<h5 id="length-for-ga-female-1">Length-for-GA: female<a class="anchor" aria-label="anchor" href="#length-for-ga-female-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_lfga_female-1.png" alt="A line graph showing the extrapolated growth curves for female length-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
<div class="section level5">
<h5 id="head-circumference-for-ga-male-1">Head circumference-for-GA: male<a class="anchor" aria-label="anchor" href="#head-circumference-for-ga-male-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_hcfga_male-1.png" alt="A line graph showing the extrapolated growth curves for male head circumference-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
<div class="section level5">
<h5 id="head-circumference-for-ga-female-1">Head circumference-for-GA: female<a class="anchor" aria-label="anchor" href="#head-circumference-for-ga-female-1"></a>
</h5>
<p><img src="extending-ig-nbs_files/figure-html/ext_plot_hcfga_female-1.png" alt="A line graph showing the extrapolated growth curves for female head circumference-for-gestational age relative to the existing growth curves. Vertical light grey dashed lines indicate where extrapolation of the original INTERGROWTH-21st Newborn Size standards starts and stops. The extrapolated data (from 154 days GA to 168 days GA for the Very Preterm standards and from 301 to 314 days in the Newborn Size standards) appears to appropriately extend these standards past the existing GA bounds, at both the median (P50) and extreme centiles (P03 and P97)." width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In all, these extrapolated versions of the Newborn Size standards
(incl. Very Preterm Newborns) should be useful for researchers with
large datasets that contain relatively extreme gestational ages. Anyone
utilising these extended standards in their work should do so with care,
and note specifically that they used the extended versions.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Parker, Bill &amp; Melinda Gates Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
